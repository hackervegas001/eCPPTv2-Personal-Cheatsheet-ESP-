
En lo que respecta a la enumeración de PostExplotación, una vez ganamos acceso a un host Linux, tenemos varias sub-categorías las cuales podemos enumerar.

**----------------------ENUMERACIÓN AUTOMÁTICA----------------------**

[LinEnum](https://github.com/rebootuser/LinEnum)
[LinPEAS](https://github.com/carlospolop/PEASS-ng/releases/tag/20230122)
[WinPEAS](https://github.com/carlospolop/PEASS-ng/releases/tag/20230122)

**--------------------------ENUMERACIÓN MANUAL-----------------------**

**-SYSTEM & NETWORK INFORMATION:**

*-Hostname*

¿Revela el nombre del equipo algo sobre la función del sistema? ¿Podemos usar esa información para ganar acceso a información relacionada con las funciones?

```
hostname
```

*-Kernel Version*

¿Es el kernel vulnerable a algún exploit?

```
uname -a
```

*-Operating System*

¿Tiene el sistema operativo algunas vulnerabilidades explotables?

```
cat /etc/issue
```

*-IP address*

```
ifconfig
ip a
```

*-Running Processes*

```
ps auxw
```

*-Network Routes

¿Está nuestra máquina comprometida ruteada a otras redes? ¿Podemos usar ésta información para pivotar?

```
route -n
```

*-DNS Server

¿Podemos obtener información del servidor DNS? Cuentas de directorio activo, zonas de transferencia, etc...

```
cat /etc/resolv.conf
```

*-Arp Cache

¿Se han comunicado otras máquinas con otro objetivo? ¿Hay otras máquinas accesibles desde la comprometida?

```
arp -a
```

*-Current Network Connections

¿Existen conexiones establecidas desde nuestra máquina a otras máquinas y viceversa? ¿Las conexiones son a través de canales encriptados o no encriptados? ¿Podemos sniffear el tráfico de esas conexiones?

```
netstat -auntp
```


**-USER INFORMATION:**

*-Current user permissions

¿Puede nuestro usuario actual acceder a detalles de información/configuración sensibles perteneciente a otros usuarios?

```
find / -user username
```

*-UID and GID Information for all users*

¿Cuántos usuarios hay en el sistema? ¿A qué grupos pertenecen? ¿Podemos modificar archivos pertenecientes a usuarios en otros grupos?

```
for user in $(cat /etc/passwd | cur -f1 -d":"); do id $user; done
```

*-Last logged on users*

¿Quién ha estado en el sistema? ¿Desde qué sistemas? ¿Podemos pivotar a esos sistemas usando credenciales que posiblemente ya tengamos?

```
last -a
```

*-Root accounts

¿Cuántas cuentas "root" (UID 0) hay en el sistema? ¿Podemos tener credenciales para alguna de ellas?

```
cat /etc/passwd | cur -f1,3,4 -d":" | grep "0:0" | cut -f1 -d":" | awk '{print $1}'
```

*-Service accounts

¿Tienen algunas de las cuentas de servicio (p.ej www-data) shells definidas? ¿Nos podemos logear a esas cuentas?

```
cat /etc/passwd
```

*-Home directories

¿Tenemos acceso a los directorios home de otros usuarios? ¿Hay alguna información dentro de esos directorios que sea útil para nosotros?

```
ls -als /home/*
```


****-PRIVILEGED ACCESS / CLEARTEXT CREDENTIALS

*- ¿Puede el usuario actual ejecutar algo con privilegios elevados?*

```
sudo -l
```

*-¿Hay binarios SUID en el sistema que puedan ser vulnerables a escalada de privilegios?*

```
find / -perm -4000 -type f 2>/dev/null
```

*-¿Podemos leer archivos de configuración que puedan contener información sensible, contraseñas, etc?*

```
grep "password" /etc/*.conf 2>/dev/null
```

*-¿Podemos leer el archivo shadow? Si la respuesta es sí, ¿podemos crackear alguno de los hashes?*

```
cat /etc/shadow
```

*-¿Podemos listar o leer los contenidos del directorio /root?

```
ls -als /root
```

*-¿Podemos leer los archivos históricos de otros usuarios?

```
find /* -name *.*history* -print 2>/dev/null
```

*-¿Podemos escribir en directorios que estén configurados para servir páginas web?

```
touch /var/www/file
```

*-Grepear el access.log de Apache para encontrar strings user o pass*

```
cat /var/log/apache/access.log | grep -E "^user|^pass"
```

*-Dumpear claves WiFi Preguardadas en texto plano del Network Manager*

```
cat /etc/NetworkManager/system-connections/* | grep -E "^id|^psk"
```


****-SERVICES

-*¿Qué servicios están configurados en el sistema y qué puertos están abriendo?*

```
netstat -auntp
```

*-¿Son los archivos de configuración del servicio legibles o escribibles por nuestro usuario actual?*

```
find /etc/init.d/ ! -uid 0 -type f 2>/dev/null | xargs ls -la
```

*-¿Podemos modificar la configuración de un servicio de una forma que nos de privilegios elevados?

```
Editar El archivo de Configuración del servicio #permisos escritura
```

*-¿Tienen los archivos de configuración alguna información que podamos usar en nuestro provecho?

```
cat /etc/mysql/my.cnf
```

*-¿Podemos parar o empezar el servicio como nuestro usuario actual?

```
service service_name start/stop
```

*-¿Qué acciones toman lugar como resultado de ser capaces de parar y empezar servicios?


**- JOBS/TASKS**

*-¿Qué tareas o trabajos está configurado el sistema para lanzar y en qué momentos?*

```
cat /etc/crontab
ls -als /etc/cron.*
```

*-¿Hay algunas tareas o trabajos configurados como root que sean escribibles?

```
find /etc/cron* -type f -perm -o+w -exec ls -l {} \;
```

*-¿Podemos modificar alguna de esas tareas/ cron jobs?


**- INSTALLED SOFTWARE VERSION INFORMATION**

*-¿Qué paquetes de software están instalados en el sistema?*

```
dpkg -l
```

*-¿Qué versiones? ¿Están desactualizadas las versiones instaladas y son vulnerables a exploits disponibles públicamente?*

```
dpkg -l
searchsploit app/servicio versión
```

*-¿Nos permite alguno de los programas instalados modificar sus archivos de configuración y podría esto resultar en ganar acceso privilegiado al sistema?

```
Intentar modificar configuraciones de los packages
```

Imagina que explotamos un servicio http vulnerable vulnerando PHP y obtenemos acceso a la máquina víctima cono www-data, hemos determinado listando los procesos que se están corriendo en el sistema que el demonio de MySQL se está ejecutando como root, es una buena idea buscar los archivos de configuración de MySQL, los cuales pueden tener las credenciales a la base de datos de MySQL, y dependiendo de su configuración, puede darnos la posibilidad de ejecutar comandos de sistema como root, como es posible con [Command Execution via User-Defined Functions (UDF)](https://bernardodamele.blogspot.com/2009/01/command-execution-with-mysql-udf.html)


**-MÓDULOS DE POST EXPLOTACIÓN DE METASPLOIT**

Requiere tener la base de datos de Metasploit activa (postgresql start -> db_status)

```
use post/linux/gather/enum_configs
use post/linux/gather/enum_system
use post/linux/TABULADOR para ver todos los módulos existentes
```


**-Privilege Escalation

**-Lateral Movement

**-Data Exfiltration

**-Maintaining Access

